import{i as E,j as T,f as D,v as I,r as a,l as N,o as q,m as H,p as R,a as l,b as c,g as v,e as h,d,h as b,w as z,T as A,c as L,q as P,_ as V,I as F,s as J,F as U,x as $,y as j,H as M,B as O,J as W}from"./index-htZnyubk.js";const X={key:0,class:"px-4 pb-2.5"},G=d("span",null,"Назад",-1),K={key:0,class:j(["pb-4 flex flex-col gap-y-2"])},Q=d("h3",{class:"px-4 font-medium text-lg"}," Товары для игр ",-1),Y={className:"grid grid-cols-2 gap-4 p-4"},te={__name:"Index",setup(Z){const n=window.Telegram.WebApp,w=E(),r=()=>{w.go(-1)};T();const k=D(L.DIRECTUS.API).with(I()),s=a(!1),o=a(null),i=a(1),f=a(50),p=a("Xbox"),m=async()=>{s.value=!0;let e=await k.request(P("Subcategories",{fields:["*.*.*"],filter:{status:{_eq:"published"},platform:{_eq:p.value}},page:i.value,limit:f.value}));return e&&e.length<f.value&&(g.value=!0),e},t=a(null),_=a(0),x=()=>{t.value&&(_.value=t.value.scrollTop,u())};N(()=>{n.onEvent("backButtonClicked",r),n.BackButton.show(),window.addEventListener("scroll",u),M(t,_)}),q(async()=>{s.value=!0;const e=window.localStorage.getItem("activeTab");e&&(p.value=JSON.parse(e).platform),o.value=await m(),s.value=!1}),H(()=>{n.offEvent("backButtonClicked",r),n.BackButton.hide(),window.removeEventListener("scroll",u)});const u=()=>{t.value.scrollTop+t.value.clientHeight>=t.value.scrollHeight-30&&(s.value||y())},g=a(!1),y=async()=>{if(!g.value){s.value=!0,i.value=i.value+1;let e=await m();if(!e)return;o.value=[...o.value,...e]}s.value=!1};return(e,ee)=>{const B=R("auto-animate");return l(),c("main",{class:"flex flex-col overflow-y-auto h-screen top-20",ref_key:"scrollableElement",ref:t,onScroll:x},[v(V),h(n).initDataUnsafe.user?b("",!0):(l(),c("div",X,[d("button",{onClick:r,class:"flex bg-blue w-fit pl-2 pr-4 py-1.5 rounded-xl items-center gap-x-1 font-medium"},[v(h(F),{icon:"ion:chevron-back-outline"}),G])])),v(A,{name:"fade"},{default:z(()=>[o.value&&o.value.length>0?(l(),c("div",K,[Q,J((l(),c("div",Y,[(l(!0),c(U,null,$(o.value,(C,S)=>(l(),O(W,{key:S,product:C,autoResize:!0},null,8,["product"]))),128))])),[[B]])])):b("",!0)]),_:1})],544)}}};export{te as default};
